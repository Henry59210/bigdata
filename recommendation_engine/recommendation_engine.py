import json

# import mysql.connector
from pyspark.sql import SparkSession
from pyspark.mllib.recommendation import ALS


# game detail data

topicsList = ["game_detail", "user_owned_games", "user_friend_list", "user_recently_played_games", "user_idx",
              "user_summary"]


def get_hdfs_dir(topic):
    return "hdfs://localhost:9000/topics/" + topic + "/partition=0/"


# result = [
#     '{"steamid":"76561198064744540","game_count":367,"games":[{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":10,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":80,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":100,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":300,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":20,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":30,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":40,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1627401040,"playtime_linux_forever":0,"playtime_windows_forever":177,"appid":50,"playtime_forever":1124},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":60,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":70,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":130,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1627832062,"playtime_linux_forever":0,"playtime_windows_forever":22,"appid":220,"playtime_forever":1861},{"playtime_mac_forever":0,"rtime_last_played":1355040000,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":340,"playtime_forever":23},{"playtime_mac_forever":0,"rtime_last_played":1524447489,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":240,"playtime_forever":420},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":280,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":360,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1343113200,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":320,"playtime_forever":2},{"playtime_mac_forever":0,"rtime_last_played":1627842204,"playtime_linux_forever":0,"playtime_windows_forever":168,"appid":380,"playtime_forever":168},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":3970,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1681092218,"playtime_linux_forever":0,"playtime_windows_forever":10627,"appid":4000,"playtime_forever":23802},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":2990,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":6220,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":6880,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":6910,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1615102799,"playtime_linux_forever":0,"playtime_windows_forever":4,"appid":2270,"playtime_forever":7},{"playtime_mac_forever":0,"rtime_last_played":1615164897,"playtime_linux_forever":0,"playtime_windows_forever":1,"appid":9000,"playtime_forever":1},{"playtime_mac_forever":0,"rtime_last_played":1543178209,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":9010,"playtime_forever":217},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":1873030,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1622442980,"playtime_linux_forever":0,"playtime_windows_forever":13,"appid":2280,"playtime_forever":430},{"playtime_mac_forever":0,"rtime_last_played":1622704180,"playtime_linux_forever":0,"playtime_windows_forever":113,"appid":2300,"playtime_forever":967},{"playtime_mac_forever":0,"rtime_last_played":1558740925,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":2290,"playtime_forever":6},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":9050,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":9070,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":208200,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1629583703,"playtime_linux_forever":0,"playtime_windows_forever":473,"appid":2310,"playtime_forever":635},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":2320,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":7670,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":409710,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1657040790,"playtime_linux_forever":0,"playtime_windows_forever":329,"appid":400,"playtime_forever":329},{"playtime_mac_forever":0,"rtime_last_played":1624149241,"playtime_linux_forever":0,"playtime_windows_forever":14,"appid":420,"playtime_forever":14},{"playtime_mac_forever":0,"rtime_last_played":1601765886,"playtime_linux_forever":0,"playtime_windows_forever":163,"appid":8200,"playtime_forever":252},{"playtime_mac_forever":0,"rtime_last_played":1601769666,"playtime_linux_forever":0,"playtime_windows_forever":62,"appid":8210,"playtime_forever":219},{"playtime_mac_forever":0,"rtime_last_played":1601772868,"playtime_linux_forever":0,"playtime_windows_forever":51,"appid":8220,"playtime_forever":134},{"playtime_mac_forever":0,"rtime_last_played":1601784054,"playtime_linux_forever":0,"playtime_windows_forever":66,"appid":8240,"playtime_forever":367},{"playtime_mac_forever":0,"rtime_last_played":1601789250,"playtime_linux_forever":0,"playtime_windows_forever":86,"appid":8250,"playtime_forever":213},{"playtime_mac_forever":0,"rtime_last_played":1642064539,"playtime_linux_forever":0,"playtime_windows_forever":532,"appid":12100,"playtime_forever":5773},{"playtime_mac_forever":0,"rtime_last_played":1367204788,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":12230,"playtime_forever":1},{"playtime_mac_forever":0,"rtime_last_played":1600760624,"playtime_linux_forever":0,"playtime_windows_forever":874,"appid":12120,"playtime_forever":5467},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":12250,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":12130,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1641037833,"playtime_linux_forever":0,"playtime_windows_forever":1,"appid":12140,"playtime_forever":1},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":12150,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":13540,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":15120,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1653036409,"playtime_linux_forever":0,"playtime_windows_forever":59,"appid":8260,"playtime_forever":59},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":8270,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":8280,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":8290,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":8300,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":12360,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1638783464,"playtime_linux_forever":0,"playtime_windows_forever":65,"appid":19900,"playtime_forever":834},{"playtime_mac_forever":0,"rtime_last_played":1601465008,"playtime_linux_forever":0,"playtime_windows_forever":218,"appid":500,"playtime_forever":2049},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":12200,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1652841238,"playtime_linux_forever":0,"playtime_windows_forever":223,"appid":10090,"playtime_forever":17584},{"playtime_mac_forever":0,"rtime_last_played":1680598144,"playtime_linux_forever":0,"playtime_windows_forever":3774,"appid":12210,"playtime_forever":5062},{"playtime_mac_forever":0,"rtime_last_played":1631059282,"playtime_linux_forever":0,"playtime_windows_forever":179,"appid":9480,"playtime_forever":556},{"playtime_mac_forever":0,"rtime_last_played":1602320826,"playtime_linux_forever":0,"playtime_windows_forever":134,"appid":1250,"playtime_forever":4660},{"playtime_mac_forever":0,"rtime_last_played":1373937921,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":35420,"playtime_forever":1},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":22330,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":22320,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1659801028,"playtime_linux_forever":0,"playtime_windows_forever":7,"appid":13570,"playtime_forever":7},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":32370,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1605490789,"playtime_linux_forever":0,"playtime_windows_forever":2,"appid":32440,"playtime_forever":3},{"playtime_mac_forever":0,"rtime_last_played":1680864088,"playtime_linux_forever":0,"playtime_windows_forever":4250,"appid":550,"playtime_forever":9141},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":41000,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":564310,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1673830385,"playtime_linux_forever":0,"playtime_windows_forever":1213,"appid":22370,"playtime_forever":1213},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":8190,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":41010,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":34270,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":32460,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":45740,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1599345846,"playtime_linux_forever":0,"playtime_windows_forever":304,"appid":57300,"playtime_forever":4536},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":70300,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1675225108,"playtime_linux_forever":0,"playtime_windows_forever":6934,"appid":22380,"playtime_forever":13513},{"playtime_mac_forever":0,"rtime_last_played":1571431383,"playtime_linux_forever":0,"playtime_windows_forever":172,"appid":42700,"playtime_forever":1388},{"playtime_mac_forever":0,"rtime_last_played":1571424363,"playtime_linux_forever":0,"playtime_windows_forever":1,"appid":42710,"playtime_forever":250},{"playtime_mac_forever":0,"rtime_last_played":1515874826,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":31280,"playtime_forever":179},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":42910,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":70000,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1627588505,"playtime_linux_forever":0,"playtime_windows_forever":957,"appid":620,"playtime_forever":3306},{"playtime_mac_forever":0,"rtime_last_played":1680598096,"playtime_linux_forever":7,"playtime_windows_forever":14594,"appid":105600,"playtime_forever":52461},{"playtime_mac_forever":0,"rtime_last_played":1640247528,"playtime_linux_forever":0,"playtime_windows_forever":2,"appid":104600,"playtime_forever":2},{"playtime_mac_forever":0,"rtime_last_played":1676902254,"playtime_linux_forever":0,"playtime_windows_forever":4,"appid":22000,"playtime_forever":4},{"playtime_mac_forever":0,"rtime_last_played":1537633531,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":55150,"playtime_forever":34},{"playtime_mac_forever":0,"rtime_last_played":1680665364,"playtime_linux_forever":0,"playtime_windows_forever":3114,"appid":24240,"playtime_forever":3114},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":3830,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":16450,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":21090,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":21100,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":21110,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":21120,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":201510,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":202200,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":67370,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":204340,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1640976776,"playtime_linux_forever":0,"playtime_windows_forever":141,"appid":108710,"playtime_forever":141},{"playtime_mac_forever":0,"rtime_last_played":1681664568,"playtime_linux_forever":0,"playtime_windows_forever":94,"appid":110800,"playtime_forever":780},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":204100,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":212630,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1561092681,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":730,"playtime_forever":2840},{"playtime_mac_forever":0,"rtime_last_played":1604286642,"playtime_linux_forever":0,"playtime_windows_forever":189,"appid":208580,"playtime_forever":189},{"playtime_mac_forever":0,"rtime_last_played":1654400973,"playtime_linux_forever":0,"playtime_windows_forever":490,"appid":202970,"playtime_forever":675},{"playtime_mac_forever":0,"rtime_last_played":1628526996,"playtime_linux_forever":0,"playtime_windows_forever":1,"appid":202990,"playtime_forever":83},{"playtime_mac_forever":0,"rtime_last_played":1654708902,"playtime_linux_forever":0,"playtime_windows_forever":485,"appid":212910,"playtime_forever":1776},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":219150,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":205100,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":57690,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1527207926,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":223470,"playtime_forever":222},{"playtime_mac_forever":0,"rtime_last_played":1633405101,"playtime_linux_forever":0,"playtime_windows_forever":1680,"appid":55230,"playtime_forever":1680},{"playtime_mac_forever":0,"rtime_last_played":1638520079,"playtime_linux_forever":0,"playtime_windows_forever":517,"appid":225140,"playtime_forever":1536},{"playtime_mac_forever":0,"rtime_last_played":1590380853,"playtime_linux_forever":0,"playtime_windows_forever":1,"appid":214510,"playtime_forever":1},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":221640,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1527381373,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":8790,"playtime_forever":81},{"playtime_mac_forever":0,"rtime_last_played":1654301121,"playtime_linux_forever":0,"playtime_windows_forever":944,"appid":12110,"playtime_forever":3115},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":12240,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":200170,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":230410,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":238070,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1624929336,"playtime_linux_forever":0,"playtime_windows_forever":19,"appid":223710,"playtime_forever":19},{"playtime_mac_forever":0,"rtime_last_played":1497099028,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":262410,"playtime_forever":14},{"playtime_mac_forever":0,"rtime_last_played":1627499508,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":223750,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":225260,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":207000,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1527381617,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":232770,"playtime_forever":1},{"playtime_mac_forever":0,"rtime_last_played":1604294308,"playtime_linux_forever":0,"playtime_windows_forever":36,"appid":234710,"playtime_forever":189},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":234650,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":35450,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":236850,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1604640740,"playtime_linux_forever":0,"playtime_windows_forever":198,"appid":240200,"playtime_forever":198},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":225080,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1679557160,"playtime_linux_forever":0,"playtime_windows_forever":45055,"appid":218620,"playtime_forever":45102},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":209000,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1642998860,"playtime_linux_forever":0,"playtime_windows_forever":1315,"appid":250760,"playtime_forever":1315},{"playtime_mac_forever":0,"rtime_last_played":1642639601,"playtime_linux_forever":0,"playtime_windows_forever":177,"appid":251570,"playtime_forever":177},{"playtime_mac_forever":0,"rtime_last_played":1619916105,"playtime_linux_forever":0,"playtime_windows_forever":80,"appid":253230,"playtime_forever":703},{"playtime_mac_forever":0,"rtime_last_played":1611459747,"playtime_linux_forever":0,"playtime_windows_forever":223,"appid":107410,"playtime_forever":223},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":257170,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":233130,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1546792070,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":255520,"playtime_forever":125},{"playtime_mac_forever":0,"rtime_last_played":1542752336,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":49520,"playtime_forever":121},{"playtime_mac_forever":0,"rtime_last_played":1652080342,"playtime_linux_forever":0,"playtime_windows_forever":2653,"appid":262060,"playtime_forever":2653},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":262150,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1561703647,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":262550,"playtime_forever":276},{"playtime_mac_forever":0,"rtime_last_played":1679276778,"playtime_linux_forever":0,"playtime_windows_forever":85,"appid":108600,"playtime_forever":85},{"playtime_mac_forever":0,"rtime_last_played":1580174558,"playtime_linux_forever":0,"playtime_windows_forever":81,"appid":270450,"playtime_forever":81},{"playtime_mac_forever":0,"rtime_last_played":1640246207,"playtime_linux_forever":0,"playtime_windows_forever":94,"appid":4500,"playtime_forever":94},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":20510,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":41700,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":270880,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1682877625,"playtime_linux_forever":432,"playtime_windows_forever":123267,"appid":271590,"playtime_forever":123699,"playtime_2weeks":104},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":232790,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1527303752,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":239200,"playtime_forever":18},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":273580,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1625980635,"playtime_linux_forever":0,"playtime_windows_forever":485,"appid":225840,"playtime_forever":1002},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":278360,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":254700,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1627065450,"playtime_linux_forever":0,"playtime_windows_forever":11,"appid":284160,"playtime_forever":11},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":285160,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1677999204,"playtime_linux_forever":0,"playtime_windows_forever":962,"appid":286160,"playtime_forever":962},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":287700,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":290510,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1527207993,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":296150,"playtime_forever":24},{"playtime_mac_forever":0,"rtime_last_played":1549046119,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":41050,"playtime_forever":144},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":41060,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":227780,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1678423385,"playtime_linux_forever":111,"playtime_windows_forever":76,"appid":238460,"playtime_forever":880},{"playtime_mac_forever":0,"rtime_last_played":1519530188,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":299030,"playtime_forever":546},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":304530,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1431797777,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":304930,"playtime_forever":56},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":238090,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1680867828,"playtime_linux_forever":0,"playtime_windows_forever":240,"appid":38410,"playtime_forever":255},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":312840,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":313690,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1635920749,"playtime_linux_forever":0,"playtime_windows_forever":1084,"appid":206420,"playtime_forever":1084},{"playtime_mac_forever":0,"rtime_last_played":1590380795,"playtime_linux_forever":0,"playtime_windows_forever":40,"appid":316610,"playtime_forever":40},{"playtime_mac_forever":0,"rtime_last_played":1604027196,"playtime_linux_forever":0,"playtime_windows_forever":607,"appid":317400,"playtime_forever":607},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":318600,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1471196211,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":319510,"playtime_forever":548},{"playtime_mac_forever":0,"rtime_last_played":1671427579,"playtime_linux_forever":0,"playtime_windows_forever":116,"appid":238010,"playtime_forever":116},{"playtime_mac_forever":0,"rtime_last_played":1599950905,"playtime_linux_forever":0,"playtime_windows_forever":628,"appid":274170,"playtime_forever":628},{"playtime_mac_forever":0,"rtime_last_played":1596309458,"playtime_linux_forever":0,"playtime_windows_forever":35,"appid":322500,"playtime_forever":35},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":690040,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":265550,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1646550605,"playtime_linux_forever":0,"playtime_windows_forever":1544,"appid":45770,"playtime_forever":1545},{"playtime_mac_forever":0,"rtime_last_played":1683179638,"playtime_linux_forever":0,"playtime_windows_forever":278,"appid":238320,"playtime_forever":278,"playtime_2weeks":278},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":327140,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1523149902,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":332800,"playtime_forever":148},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":337360,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":341190,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1636703348,"playtime_linux_forever":0,"playtime_windows_forever":491,"appid":301910,"playtime_forever":491},{"playtime_mac_forever":0,"rtime_last_played":1677045010,"playtime_linux_forever":3,"playtime_windows_forever":2971,"appid":346900,"playtime_forever":20560},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":21690,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1530654898,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":354140,"playtime_forever":384},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":355170,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":356570,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1663922537,"playtime_linux_forever":0,"playtime_windows_forever":2173,"appid":232090,"playtime_forever":2230},{"playtime_mac_forever":0,"rtime_last_played":1627162279,"playtime_linux_forever":0,"playtime_windows_forever":1418,"appid":362890,"playtime_forever":2562},{"playtime_mac_forever":0,"rtime_last_played":1519587170,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":363970,"playtime_forever":64},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":366260,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1626089642,"playtime_linux_forever":0,"playtime_windows_forever":99,"appid":365670,"playtime_forever":99},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":367520,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1670224794,"playtime_linux_forever":0,"playtime_windows_forever":35,"appid":383150,"playtime_forever":35},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":383180,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":388410,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1632705991,"playtime_linux_forever":0,"playtime_windows_forever":446,"appid":391540,"playtime_forever":446},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":329380,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":394550,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":250180,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":312610,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":366250,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1677027187,"playtime_linux_forever":61,"playtime_windows_forever":0,"appid":397460,"playtime_forever":61},{"playtime_mac_forever":0,"rtime_last_played":1635146931,"playtime_linux_forever":0,"playtime_windows_forever":620,"appid":397540,"playtime_forever":620},{"playtime_mac_forever":0,"rtime_last_played":1657590164,"playtime_linux_forever":0,"playtime_windows_forever":118,"appid":401680,"playtime_forever":118},{"playtime_mac_forever":0,"rtime_last_played":1557776735,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":365450,"playtime_forever":74},{"playtime_mac_forever":0,"rtime_last_played":1680289892,"playtime_linux_forever":1,"playtime_windows_forever":1245,"appid":413150,"playtime_forever":9977},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":225540,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":414700,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1475502206,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":417860,"playtime_forever":41},{"playtime_mac_forever":0,"rtime_last_played":1646038852,"playtime_linux_forever":0,"playtime_windows_forever":1709,"appid":427190,"playtime_forever":1709},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":268500,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":210970,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1683020769,"playtime_linux_forever":0,"playtime_windows_forever":3513,"appid":239140,"playtime_forever":3513,"playtime_2weeks":360},{"playtime_mac_forever":0,"rtime_last_played":1678955711,"playtime_linux_forever":0,"playtime_windows_forever":49,"appid":431960,"playtime_forever":49},{"playtime_mac_forever":0,"rtime_last_played":1656622118,"playtime_linux_forever":0,"playtime_windows_forever":407,"appid":433340,"playtime_forever":407},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":441380,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1651821129,"playtime_linux_forever":0,"playtime_windows_forever":36,"appid":442780,"playtime_forever":36},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":443810,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":445980,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1677967635,"playtime_linux_forever":0,"playtime_windows_forever":520,"appid":365590,"playtime_forever":520},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":524440,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1638351117,"playtime_linux_forever":0,"playtime_windows_forever":579,"appid":447530,"playtime_forever":579},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":447780,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":456780,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":50620,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":462780,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":468670,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1628980924,"playtime_linux_forever":0,"playtime_windows_forever":1628,"appid":379720,"playtime_forever":1628},{"playtime_mac_forever":0,"rtime_last_played":1678002230,"playtime_linux_forever":0,"playtime_windows_forever":168,"appid":470220,"playtime_forever":168},{"playtime_mac_forever":0,"rtime_last_played":1660337687,"playtime_linux_forever":0,"playtime_windows_forever":16,"appid":489830,"playtime_forever":16},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":491950,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1654741270,"playtime_linux_forever":0,"playtime_windows_forever":5020,"appid":311210,"playtime_forever":5020},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":508440,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1582472984,"playtime_linux_forever":0,"playtime_windows_forever":54,"appid":292030,"playtime_forever":54},{"playtime_mac_forever":0,"rtime_last_played":1612331586,"playtime_linux_forever":0,"playtime_windows_forever":548,"appid":418370,"playtime_forever":548},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":311340,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":548430,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1662952436,"playtime_linux_forever":0,"playtime_windows_forever":59,"appid":562860,"playtime_forever":426},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":572890,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":578720,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":582500,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1669005962,"playtime_linux_forever":0,"playtime_windows_forever":41,"appid":588650,"playtime_forever":41},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":590380,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1661321594,"playtime_linux_forever":0,"playtime_windows_forever":6177,"appid":460930,"playtime_forever":6177},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":611760,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":402130,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":623940,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1673249803,"playtime_linux_forever":0,"playtime_windows_forever":195,"appid":632360,"playtime_forever":195},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":648800,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":664830,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1645095254,"playtime_linux_forever":0,"playtime_windows_forever":500,"appid":673130,"playtime_forever":500},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":674940,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1680598142,"playtime_linux_forever":0,"playtime_windows_forever":137,"appid":393080,"playtime_forever":137},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":393100,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1673425432,"playtime_linux_forever":0,"playtime_windows_forever":9984,"appid":377160,"playtime_forever":9987},{"playtime_mac_forever":0,"rtime_last_played":1605529907,"playtime_linux_forever":0,"playtime_windows_forever":115,"appid":714070,"playtime_forever":115},{"playtime_mac_forever":0,"rtime_last_played":1682675210,"playtime_linux_forever":0,"playtime_windows_forever":585,"appid":739630,"playtime_forever":585,"playtime_2weeks":34},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":753640,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1643256604,"playtime_linux_forever":0,"playtime_windows_forever":517,"appid":519860,"playtime_forever":3374},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":298900,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1618420722,"playtime_linux_forever":0,"playtime_windows_forever":1,"appid":816090,"playtime_forever":1},{"playtime_mac_forever":0,"rtime_last_played":1676174924,"playtime_linux_forever":0,"playtime_windows_forever":2582,"appid":552520,"playtime_forever":2582},{"playtime_mac_forever":0,"rtime_last_played":1656145841,"playtime_linux_forever":0,"playtime_windows_forever":252,"appid":824600,"playtime_forever":252},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":834530,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1580118652,"playtime_linux_forever":0,"playtime_windows_forever":43,"appid":552500,"playtime_forever":43},{"playtime_mac_forever":0,"rtime_last_played":1640423861,"playtime_linux_forever":0,"playtime_windows_forever":1147,"appid":863550,"playtime_forever":1147},{"playtime_mac_forever":0,"rtime_last_played":1623867735,"playtime_linux_forever":0,"playtime_windows_forever":228,"appid":871720,"playtime_forever":228},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":517630,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1641775713,"playtime_linux_forever":0,"playtime_windows_forever":258,"appid":638970,"playtime_forever":258},{"playtime_mac_forever":0,"rtime_last_played":1530048585,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":823130,"playtime_forever":3},{"playtime_mac_forever":0,"rtime_last_played":1682060352,"playtime_linux_forever":0,"playtime_windows_forever":494,"appid":883710,"playtime_forever":494,"playtime_2weeks":23},{"playtime_mac_forever":0,"rtime_last_played":1614417596,"playtime_linux_forever":0,"playtime_windows_forever":168,"appid":892970,"playtime_forever":168},{"playtime_mac_forever":0,"rtime_last_played":1645695312,"playtime_linux_forever":0,"playtime_windows_forever":425,"appid":893030,"playtime_forever":425},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":893680,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":606280,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":611500,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1602034036,"playtime_linux_forever":0,"playtime_windows_forever":17,"appid":945360,"playtime_forever":17},{"playtime_mac_forever":0,"rtime_last_played":1652865760,"playtime_linux_forever":0,"playtime_windows_forever":657,"appid":960090,"playtime_forever":657},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":969990,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1677349350,"playtime_linux_forever":221,"playtime_windows_forever":946,"appid":35140,"playtime_forever":1167},{"playtime_mac_forever":0,"rtime_last_played":1677565059,"playtime_linux_forever":0,"playtime_windows_forever":1167,"appid":200260,"playtime_forever":1167},{"playtime_mac_forever":0,"rtime_last_played":1679200526,"playtime_linux_forever":0,"playtime_windows_forever":3133,"appid":208650,"playtime_forever":3133},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":450390,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1663751976,"playtime_linux_forever":0,"playtime_windows_forever":14,"appid":1010750,"playtime_forever":703},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":939960,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1650255978,"playtime_linux_forever":0,"playtime_windows_forever":105,"appid":1051690,"playtime_forever":105},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":1061910,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":927380,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1676818845,"playtime_linux_forever":0,"playtime_windows_forever":77,"appid":1070550,"playtime_forever":77},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":359320,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1677094774,"playtime_linux_forever":1,"playtime_windows_forever":357,"appid":1082710,"playtime_forever":358},{"playtime_mac_forever":0,"rtime_last_played":1664089433,"playtime_linux_forever":0,"playtime_windows_forever":8481,"appid":782330,"playtime_forever":8496},{"playtime_mac_forever":0,"rtime_last_played":1628632314,"playtime_linux_forever":0,"playtime_windows_forever":755,"appid":1148590,"playtime_forever":755},{"playtime_mac_forever":0,"rtime_last_played":1642468834,"playtime_linux_forever":0,"playtime_windows_forever":4902,"appid":976730,"playtime_forever":4902},{"playtime_mac_forever":0,"rtime_last_played":1679565263,"playtime_linux_forever":0,"playtime_windows_forever":256,"appid":1150760,"playtime_forever":256},{"playtime_mac_forever":0,"rtime_last_played":1611036909,"playtime_linux_forever":0,"playtime_windows_forever":2851,"appid":1085660,"playtime_forever":2851},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":1172380,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1680761606,"playtime_linux_forever":81,"playtime_windows_forever":20812,"appid":1174180,"playtime_forever":20894},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":1179080,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1621194652,"playtime_linux_forever":0,"playtime_windows_forever":807,"appid":1196590,"playtime_forever":807},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":1229490,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":1236300,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":1238080,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":1238840,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":1237970,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1609402998,"playtime_linux_forever":0,"playtime_windows_forever":81,"appid":1237950,"playtime_forever":81},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":760620,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":442070,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":203160,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":289690,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1641008789,"playtime_linux_forever":0,"playtime_windows_forever":30,"appid":1275350,"playtime_forever":30},{"playtime_mac_forever":0,"rtime_last_played":1657764378,"playtime_linux_forever":0,"playtime_windows_forever":1843,"appid":1281930,"playtime_forever":1843},{"playtime_mac_forever":0,"rtime_last_played":1612385148,"playtime_linux_forever":0,"playtime_windows_forever":319,"appid":1286830,"playtime_forever":319},{"playtime_mac_forever":0,"rtime_last_played":1680603592,"playtime_linux_forever":66,"playtime_windows_forever":2259,"appid":1290000,"playtime_forever":2326},{"playtime_mac_forever":0,"rtime_last_played":1653942191,"playtime_linux_forever":0,"playtime_windows_forever":710,"appid":1304550,"playtime_forever":710},{"playtime_mac_forever":0,"rtime_last_played":1674806982,"playtime_linux_forever":0,"playtime_windows_forever":29544,"appid":1151340,"playtime_forever":29544},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":1332010,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":266310,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1650445308,"playtime_linux_forever":0,"playtime_windows_forever":49,"appid":1379630,"playtime_forever":49},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":719040,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":1406780,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1673516325,"playtime_linux_forever":0,"playtime_windows_forever":131,"appid":1426210,"playtime_forever":131},{"playtime_mac_forever":0,"rtime_last_played":1639384150,"playtime_linux_forever":0,"playtime_windows_forever":96,"appid":1435790,"playtime_forever":96},{"playtime_mac_forever":0,"rtime_last_played":1635569737,"playtime_linux_forever":0,"playtime_windows_forever":172,"appid":1465510,"playtime_forever":172},{"playtime_mac_forever":0,"rtime_last_played":1670408341,"playtime_linux_forever":0,"playtime_windows_forever":69,"appid":976310,"playtime_forever":69},{"playtime_mac_forever":0,"rtime_last_played":1675578103,"playtime_linux_forever":0,"playtime_windows_forever":2544,"appid":1293830,"playtime_forever":2544},{"playtime_mac_forever":0,"rtime_last_played":1662090510,"playtime_linux_forever":0,"playtime_windows_forever":481,"appid":1583720,"playtime_forever":481},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":1621690,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1657576245,"playtime_linux_forever":0,"playtime_windows_forever":393,"appid":1640300,"playtime_forever":393},{"playtime_mac_forever":0,"rtime_last_played":1656331304,"playtime_linux_forever":0,"playtime_windows_forever":296,"appid":1703340,"playtime_forever":296},{"playtime_mac_forever":0,"rtime_last_played":1642904858,"playtime_linux_forever":0,"playtime_windows_forever":446,"appid":1240440,"playtime_forever":446},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":1817070,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1676719789,"playtime_linux_forever":0,"playtime_windows_forever":128,"appid":1659040,"playtime_forever":128},{"playtime_mac_forever":0,"rtime_last_played":1675943585,"playtime_linux_forever":5,"playtime_windows_forever":0,"appid":1902490,"playtime_forever":5},{"playtime_mac_forever":0,"rtime_last_played":1682918011,"playtime_linux_forever":0,"playtime_windows_forever":56,"appid":1943950,"playtime_forever":56,"playtime_2weeks":56},{"playtime_mac_forever":0,"rtime_last_played":1680565954,"playtime_linux_forever":0,"playtime_windows_forever":56,"appid":1985810,"playtime_forever":56},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":346110,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":407530,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":40990,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1681807083,"playtime_linux_forever":8,"playtime_windows_forever":2698,"appid":2050650,"playtime_forever":2707},{"playtime_mac_forever":0,"rtime_last_played":1680917306,"playtime_linux_forever":0,"playtime_windows_forever":575,"appid":2225070,"playtime_forever":575},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":2231380,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":1674465726,"playtime_linux_forever":0,"playtime_windows_forever":1461,"appid":1546970,"playtime_forever":1461},{"playtime_mac_forever":0,"rtime_last_played":1675169143,"playtime_linux_forever":47,"playtime_windows_forever":1536,"appid":1546990,"playtime_forever":1583},{"playtime_mac_forever":0,"rtime_last_played":1676630937,"playtime_linux_forever":95,"playtime_windows_forever":2812,"appid":1547000,"playtime_forever":2907},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":2324650,"playtime_forever":0},{"playtime_mac_forever":0,"rtime_last_played":0,"playtime_linux_forever":0,"playtime_windows_forever":0,"appid":1712840,"playtime_forever":0}]}']

if __name__ == '__main__':
    # for i in topicsList:
    #     spark = SparkSession.builder \
    #         .appName("Read HDFS Files") \
    #         .getOrCreate()
    #     #  HDFS 
    #     hdfs_dir = get_hdfs_dir(i)
    #
    #     # 
    #     file_content = spark.sparkContext.textFile(hdfs_dir).collect()

    # userid
    # rdd = spark.sparkContext.parallelize(result)
    # rows = rdd.map(lambda x: eval(x)).map(lambda x: (x['user_id'],)).distinct().map(lambda x: (x[0],)).map(
    #     lambda x: tuple(x))
    # schema = StructType([StructField("user_id", StringType(), True)])
    # userIdxDf = spark.createDataFrame(rows, schema)

    # user ownd game
    spark = SparkSession.builder.appName("games").getOrCreate()


    # try:
    #     df_tmp = spark.sql("SELECT * FROM game_detail")
    #     print('***************************************************************************************************************')
    #     spark.sql("SELECT EXPLODE('games') AS played_games FROM user_owned_games").show()
    #     print('***************************************************************************************************************')
    #     spark.sql("SELECT played_games['appid'] AS game_id, played_games['playtime_forever'] AS playtime_forever \
    #              FROM (SELECT EXPLODE('games') AS played_games FROM user_owned_games)").show()
    # except:
    #     pass

    # rdd = spark.sparkContext.parallelize(result)
    #
    # userOwnedGameDf = spark.read.json(rdd)
    #
    # userOwnedGameDf = userOwnedGameDf.selectExpr("explode(games) as game") \
    #     .selectExpr("game.appid as appid",
    #                 "game.playtime_forever as playtime_forever",
    #                 "game.playtime_windows_forever as playtime_windows_forever",
    #                 "game.playtime_linux_forever as playtime_linux_forever",
    #                 "game.playtime_mac_forever as playtime_mac_forever",
    #                 "game.rtime_last_played as rtime_last_played")
    #
    # userOwnedGameDf.show()

    # #Load User Owned Games
    # # top 10 games which have longest total played hours

    # spark.sql("SELECT * FROM user_owned_games").show()
    # print('***************************************************************************************************************')
    # spark.sql("SELECT * FROM game_detail").show()
    # print('***************************************************************************************************************')
    # df_global_popular_games = df_user_owned_games.select(df_user_owned_games.appid.alias("game_id"), "playtime_forever AS playtime_forever").groupby("game_id").agg({"playtime_forever":"sum"}).withColumnRenamed("sum(playtime_forever)", "play_time").orderBy("play_time", ascending=False).limit(10)
    # df_global_popular_games.registerTempTable('popular_games')
    #
    # df_global_popular_games.show()
    #
    # Load
    # User
    # Owned
    # Games
    df_user_owned_games = spark.read.json("hdfs://localhost:9000/topics/user_owned_games/partition=0/*.json")
    df_user_owned_games.registerTempTable("user_owned_games")

    df_game_detail = spark.read.json("hdfs://localhost:9000/topics/game_detail/partition=0/*.json")
    df_game_detail.registerTempTable("game_detail")
    # df_valid_game = spark.sql("SELECT * FROM temp_game_detail where _corrupt_record is null")
    # df_valid_game.registerTempTable("game_detail")
    # df_valid_game.show(1)
    # # top 10 games which have longest total played hours
    df_global_popular_games = \
        spark.sql("SELECT b.game_id, SUM(b.playtime_forever) AS play_time FROM \
                (SELECT played_games['appid'] AS game_id, played_games['playtime_forever'] AS playtime_forever \
                FROM (SELECT EXPLODE(games) AS played_games FROM user_owned_games) a) b \
                GROUP BY game_id ORDER BY play_time DESC LIMIT 10")
    df_global_popular_games.registerTempTable('popular_games')
    # find same app id in popular_games and game_detail
    # total played_hours is defined as ranks
    df_global_popular_games = spark.sql("SELECT b.name AS name, a.play_time AS ranks, b.steam_appid, b.header_image FROM \
                                        popular_games a, game_detail b WHERE a.game_id = b.steam_appid ORDER BY ranks DESC")
    df_global_popular_games.show()

    # df_global_popular_games = df_game_detail.join(df_global_popular_games, df_game_detail.steam_appid == df_global_popular_games.game_id).select(df_game_detail.name.alias('name'), df_global_popular_games.play_time.alias("ranks"), df_game_detail.steam_appid, df_game_detail.header_image).orderBy("ranks", ascending=False)
    # df_global_popular_games.show()

    # #Local
    # Popularity
    # #find his/her friends
    df_user_friend_list = spark.read.json("hdfs://localhost:9000/topics/user_friend_list/partition=0/*.json")
    df_user_friend_list.registerTempTable("friend_list")
    sample_user = '76561198064744540'
    df_friend_list = spark.sql("SELECT friends['steamid'] AS steamid FROM \
                (SELECT EXPLODE(friends) AS friends FROM friend_list WHERE steamid = %s) a" % sample_user)
    df_friend_list.show(10)
    df_friend_list.registerTempTable('user_friend_list')
    # find out the total playtime of all friends for each game
    spark.sql("SELECT game_id, SUM(playtime_forever) AS play_time FROM \
                (SELECT games['appid'] AS game_id, games['playtime_forever'] AS playtime_forever FROM \
                (SELECT a.steamid, EXPLODE(b.games) AS games \
                FROM user_friend_list a, user_owned_games b WHERE a.steamid = b.steamid) c) d \
                GROUP BY game_id ORDER BY play_time DESC LIMIT 10") \
        .registerTempTable('temp_local_popular_games')

    df_global_popular_games = spark.sql("SELECT DISTINCT b.name AS game_name, a.play_time FROM \
                                            temp_local_popular_games a, game_detail b WHERE a.game_id = b.steam_appid")
    df_global_popular_games.show()


    # df_user_firend_list = spark.read.json()
    # df_user_firend_list.registerTempTable('friend_list')
    # #friend_listfriendsdfgame_list
    # sample_user = ''
    # friends = df_user_firend_list.select(explode("friends").alias("friends")).filter('steamid = ' + sample_user)
    # #sample_user = ''
    # df_friend_list = friends.select(friends.steamid.alias('steamid'))
    # df_friend_list.show(10)
    # df_friend_list.registerTempTable('user_friend_list')
    # #find out the total playtime of all friends for each game
    # temp_df = df_user_firend_list.join(userOwnedGameDf, 'steamid').select(df_user_firend_list.steamid, explode(userOwnedGameDf.games).alias("games"))
    # temp_df.select('appid'.alias("game_id"), 'playtime_forever').select("game_id")

    # Collaborative
    # Filtering
    # Recommendation
    # System
    df_user_recent_games = spark.read.json("hdfs://localhost:9000/topics/user_recently_played_games/partition=0/*.json")
    df_user_recent_games.registerTempTable("user_recent_games")
    df_valid_user_recent_games = spark.sql("SELECT * FROM user_recent_games where total_count != 0")
    df_valid_user_recent_games.show(1)

    df_user_idx = spark.read.json("hdfs://localhost:9000/topics/user_idx/partition=0/*.json")
    df_user_idx.registerTempTable('user_idx')
    df_valid_user_recent_games = spark.sql("SELECT b.user_idx, a.games FROM user_recent_games a \
                                                JOIN user_idx b ON b.user_id = a.steamid WHERE a.total_count != 0")
    df_valid_user_recent_games.show(10)

    # map and filter out the games whose playtime is 0
    training_rdd = df_valid_user_recent_games.rdd.flatMapValues(lambda x: x) \
        .map(lambda x_y: (x_y[0], x_y[1].appid, x_y[1].playtime_forever)) \
        .filter(lambda x_y_z: x_y_z[2] > 0)
    training_rdd.collect()

    als_model = ALS.trainImplicit(training_rdd, 10)
    # print out 10 recommendeds product for user of index 0
    result_rating = als_model.recommendProducts(0, 10)
    # print result_rating
    try_df_result = spark.createDataFrame(result_rating)
    # print
    try_df_result.sort("rating", ascending=False).show()


#     MySQL
#     cnx = mysql.connector.connect(user='root', password='111111',
#                                   host='localhost',
#                                   database='big_data')

    #
    # json
    sample_recommended = 'sample_result/sample_recommended.json'
    # xdefaultMySQL
    with open(sample_recommended, 'x') as output_file:
        for user_idx in range(0, df_user_idx.count()):
            try:
                lst_recommended = [i.product for i in als_model.recommendProducts(user_idx, 10)]
                ranks = 1
                for app_id in lst_recommended:
                    dict_recommended = {'user_idx': user_idx, 'game_id': app_id, 'ranks': ranks}
                    json.dump(dict_recommended, output_file)
                    output_file.write('\n')
                    ranks += 1
            # some user index may not in the recommendation result since it's been filtered out
            except:
                pass

    df_recommend_result = spark.read.json(sample_recommended)
    df_recommend_result.show(20)

    df_recommend_result.registerTempTable('recommend_result')
    # df_final_recommend_resultMySQL(json)
    df_final_recommend_result = spark.sql("SELECT DISTINCT b.user_id, a.ranks, c.name, c.header_image, c.steam_appid \
                                            FROM recommend_result a, user_idx b, game_detail c \
                                            WHERE a.user_idx = b.user_idx AND a.game_id = c.steam_appid \
                                            ORDER BY b.user_id, a.ranks")
    df_final_recommend_result.show(20)
    url = 'jdbc:mysql://20.2.240.50/big_data?serverTimezone=Asia/Shanghai'
    mode = 'overwrite'
    properties = {
        "user": "root",
        "password": "111111",
        "driver": 'com.mysql.cj.jdbc.Driver'
    }
    final_recommend_result_table = 'personal_recommendation'
    df_final_recommend_result.write.jdbc(url=url, mode=mode, properties=properties, table=final_recommend_result_table)

    #     MySQLstore the recommendation results to aws rdsdf_global_popular_games
    #     ...game_detail
    #     friend_listglobalrankfriends
    df_global_popular_games = spark.sql("SELECT DISTINCT b.name AS name, a.play_time AS ranks, b.steam_appid, b.header_image FROM \
                                                temp_local_popular_games a, game_detail b WHERE a.game_id = b.steam_appid")
    global_popular_games_table = 'popular_games'
    df_global_popular_games.write.jdbc(url=url, mode=mode, properties=properties, table=global_popular_games_table)
#     ,game_detaildfdfcleanclean





